// ==UserScript==
// @name         JPDB Badges
// @namespace    http://tampermonkey.net/
// @version      1.0
// @description  Add badges to reviews for frequency and grammar points. (mix of already existing scripts)
// @author       maooowooo
// @author       S9B52D6 (Frequency)
// @author       luizbafilho (Grammar) 
// @match        https://jpdb.io/review
// @icon         https://www.google.com/s2/favicons?sz=64&domain=jpdb.io
// ==/UserScript==

(async function () {
    'use strict';

    waitForElm('.subsection-meanings .subsection-label').then((elm) => {
        let badgesContainer = document.createElement('div')
        badgesContainer.classList.add("badges")
        document.querySelector('.answer-box > div:nth-child(2)').insertAdjacentElement('afterend', badgesContainer)
    });

    getFrequency();
    getGrammarBadge();
})();

async function getFrequency() {

    const id = document.getElementsByClassName("row-1")[0].children[0][0].value.split(",")[1]
    const word = document.getElementsByClassName("answer-box")[0].children[1].children[2].textContent
    var url = `https://jpdb.io/vocabulary/${id}/${word}`

    var xmlhttp = window.XMLHttpRequest ? new XMLHttpRequest() : null
    xmlhttp.open("GET", url, true)
    xmlhttp.send()

    xmlhttp.addEventListener("loadend", e => {
        var dummy = document.createElement("html")
        dummy.innerHTML = xmlhttp.response
        const index = dummy.getElementsByClassName("tooltip")[0].innerHTML == "⚠" ? 1 : 0
        const frequency = dummy.getElementsByClassName("tooltip")[index].innerHTML || ""

        if (frequency == null) return;

        waitForElm('.badges').then((elm) => {
            var topBadge = document.createElement("span");
            topBadge.classList.add("top-badge")
            topBadge.classList.add("badge")
            topBadge.innerHTML = frequency.replace("Top", "<")
            elm.insertAdjacentElement('beforeend', topBadge)
        }
        );
    })
}

function getGrammarBadge() {
    var grammarPoints = ["あげる", "間・あいだ(に)", "あまり", "ある", "あとで", "ば", "ばかり", "ばよかった", "だい", "だけ", "だけで(は)なく～(も)", "だろう", "出す・だす", "で", "でも", "どう", "へ", "が", "がる", "ごろ", "ごとに", "始める・はじめる", "はず", "ほど", "ほうがいい", "ほうが~より", "欲しい・ほしい", "一番・いちばん", "行く・いく", "いる", "要る・いる", "自分・じぶん", "か", "か(どうか)", "かい", "かもしれない", "から", "かしら", "方・かた", "代わりに・かわりに", "けれども", "聞こえる・きこえる", "嫌いだ・きらいだ", "こと", "ことがある", "ことが出来る・できる", "ことになる", "ことにする", "ことは", "下さい・ください", "君・くん", "くらい", "呉れる・くれる", "来る・くる", "まだ", "まで", "までに", "前に・まえに", "毎・まい", "まま", "ましょう", "見える・みえる", "みる", "も", "もう", "も~も", "もの(だ)", "もらう", "な", "など", "ながら", "ないで", "なければならない", "なくなる", "なくて", "なら", "なさい", "ね", "に", "に違いない・にちがいない", "難い・にくい", "にしては", "にする", "の", "のだ", "ので", "のに", "のは～だ", "お", "を", "多い・おおい", "おく", "お～になる", "お～する", "終わる・おわる", "られる", "らしい", "Relative Clause", "さ", "様・さま", "させる", "せっかく", "し", "しい", "しか", "しまう", "知る・しる", "そうだ", "それで", "それでは", "それから", "それなら", "それとも", "そして", "過ぎる・すぎる", "好きだ・すきだ", "少ない・すくない", "する", "すると", "たい", "堪らない・たまらない", "為(に)・ため(に)", "たら", "たらどうですか", "たり～たりする", "たって", "て", "ても", "てもいい", "と", "と言えば", "という", "とか", "時・とき", "ところだ", "として", "としては", "つもり", "って", "うちに", "は", "わ", "は～だ", "は～が", "はいけない", "分かる・わかる", "わけだ", "屋・や", "や", "やはり", "易い・やすい", "ようだ", "ように", "ように言う", "ようになる", "ようにする", "より", "ようと思う", "ずつ", "~ば~ほど", "~ばかりか~(さえ)", "べきだ", "分", "だが", "だからと言って", "だけで", "だらけ", "であろう", "である", "どころか", "どうも", "どんなに~(こと)か", "どうせ", "風に", "がち", "がたい", "逆に", "以外", "以上(は)", "いかにも", "Imperative", "一方で(は)他方で(は)", "上", "かえって", "限り", "か~か", "かな", "必ずしも", "かねる", "から~に至るまで", "から~にかけて", "からと言って", "かろう", "方をする", "かと言うと", "(の)代わりに", "結果", "結構", "この", "こうした", "こそ", "ことで", "ことによる", "ことはない", "く", "くせに", "までもない", "まい", "まさか", "ましだ", "または", "目", "面", "みせる", "も~ば", "なあ", "などと", "ながら(も)", "ないことも/ はない", "なかなか", "なく", "何でも", "何しろ", "ならない", "なり~なり", "なりに", "なしでは", "ねばならない", "に当たって/当たり", "に反して/反する", "にほかならない", "に限らず", "に限って", "に関して/関する", "に代わって", "に比べると/比べて", "にもかかわらず", "に基づいて/基づく", "になると", "において/おける", "に従って/従い", "に過ぎない", "に対して/対する", "にとって", "について", "につき", "につれて/つれ", "には", "によって/より", "の関係で", "のこと", "のことだから", "のみ", "の下で", "の上では", "のは~のことだ", "ぬ", "お~だ", "をはじめ(として)", "お~下さい", "思われる", "おり", "を通して", "っぱなし", "っぽい", "来", "例の", "Rhetorical Question", "ろくに~ない", "さえ", "際(に)", "さすが", "せい", "せめて", "次第", "しかも", "したがって", "そうかと言って", "そこで", "そこを", "そうになる", "その上", "それでも", "それどころか", "それが", "それも", "それに", "それと", "それは", "それぞれ", "すぐ", "たびに", "ただ", "ただの", "確かに~が", "たところで", "て初めて", "点(で)", "ては", "と同時に", "と言っても", "という風に", "ということは", "というのに", "というのは~ことだ", "と言うと", "というより(は)", "とかで", "ところ", "ところが", "とも", "となる", "となると", "通り(に)", "とする", "途端(に)", "とうとう", "と共に", "とは限らない", "つまり", "つつ", "(の)上で", "上(に)", "得る　(うる・える)", "Vmasu", "Vmasu as a Noun", "は言うまでもなく", "わけではない", "わけがない", "わけにはいかない", "やる", "やっと", "よう", "ざるを得ない", "ぞ", "あえて", "あげく(に)", "あくまでも", "あながち～ない", "あるいは", "あたかも", "ばかりに", "ばこそ", "べからず・べからざる", "べく", "べくもない", "べくして", "ちなみに", "だけあって", "だけに", "だけのことはある", "だに", "だの", "だって", "であれ", "～であれ～であれ", "でも・じゃあるまいし", "～でも[Wh. word]でも", "どちらかと言うと", "どうか", "どころではない", "ども", "どうにも～ない", "同士", "が早いか", "～が～なら", "ごとし", "反面", "はたして", "ひいては", "一[Counter]として～ない", "ひとつ", "一つには", "一応", "如何(だ)", "いかなる", "いかに", "いくら", "今更", "一方(だ)", "一方(で)", "以来", "一切～ない", "一旦", "言ってみれば", "言うまでもない", "言わば", "いわゆる", "自体", "限りだ", "甲斐", "か否か", "かのように", "から言って", "からなる", "からには", "からして", "仮に", "かと思うと", "且つ・かつ", "きらいがある", "(っ)きり", "っけ", "この上ない", "ことか", "ことから", "ことに", "加えて", "まで(のこと)だ", "まして(や)", "また", "滅多に～ない", "見るからに", "～も[V]ば～も[V]", "ものではない", "ものか", "ものなら", "ものの", "ものを", "もさることながら", "もしくは", "もっとも", "向け", "むしろ", "ないでもない", "ないことには", "ないまでも", "ないし(は)", "中を", "なくして(は)", "なまじ(っか)", "並み", "何[(Number)+Counter]も", "何～ない", "何も～ない", "何らかの", "何ら～ない", "なんて", "何とか", "なお", "なおさら", "ならでは(の)", "並びに", "なり", "なるほど", "なしに", "なす", "なぜか", "なぜなら(ば)～からだ", "んばかり(に)", "願う・願います", "にひきかえ", "にいたっては", "に関・拘・係わらず", "にかけては", "に難くない", "に決まっている", "に越したことはない", "に・ともなると", "に向けて・に向けた", "～に～ない", "に(も)なく", "に応じて・応じて", "にしろ・せよ", "にしたところで", "にして", "にしてからが", "にしても", "にとどまらず", "につけ", "にわたって・わたる", "によらず", "によると", "のみならず", "のなんのって", "の無さ", "～の～のと", "んとする", "を中心に", "を介して/介した", "を禁じ得ない", "をめぐって・めぐる", "思えば", "をものともせず", "思うに", "をおいてほかに(は)～ない", "折(に)", "恐れがある", "を問わず", "及び", "およそ", "をよそに", "さも", "更に", "さて", "さぞ(かし)", "そもそも(の)", "そのもの", "それだけ", "それなりに・の", "末(に)", "済む", "但し", "たかが", "たなり(で)", "単位で", "単に", "たるや", "(っ)たって", "てばかりはいられない", "～ても～ても", "て仕方がない", "てはいられない", "とあって", "とあっては", "とばかりに", "とでも言うべき", "といえども", "～といい～といい", "といった", "といったところだ", "と言って", "と言うか", "と言うのは", "と言わず~と言わず", "ところから", "ともなく", "ともすると", "との", "とても～ない", "とは", "とは言え", "つい", "ついでに", "ついては", "(と言)ったらない", "はあれ", "は別として", "はいいとしても", "はおろか", "割に(は)", "～わ～わ", "や否や・やいなや", "やら", "～やら～やら", "ようでは", "ようものなら", "ようにも(～ない)", "より・のほか(に)(は)～ない", "由", "ようと・が", "故に", "ずにはおかない", "ずして", "ずとも", "間", "上がる", "あくまで", "あげく", "上げる", "あっての", "後1", "あと2", "あとから", "あとは…だけ", "改める", "あるまじき…だ", "あれで", "あれでも", "あんまり", "いい", "言う", "以下", "意外", "いかん", "以後", "いささか", "いざしらず", "以上", "いずれ1", "いずれ2", "依然", "以前", "至り", "一概に…ない", "一度", "いつか", "一向に", "一切", "いつしか", "一層", "一体", "一旦…と", "一方", "以内", "今頃", "未だ", "今でこそ", "今に", "今にも", "今や", "いわば", "所謂", "内", "うる", "お…致す", "お…頂く", "お…下さる", "お…する", "お…です", "お…なさる", "お…になる", "お…願う", "おいそれと（は）…ない", "おいて", "おかげで", "置きに", "おそらく", "同じ", "覚えはない", "おまけに", "思う", "思ったら", "が1", "が2", "却って", "変える", "がかり", "がかる", "限る", "かくして", "かけ", "かける", "が最後", "難い", "かたがた", "傍ら", "且つ", "嘗て", "がてら", "かと思うほど", "かと思えば", "かと思ったら", "がな", "必ず", "必ずしも…ない", "兼ねない", "兼ねる", "かも分からない", "から1", "から2", "から良い", "から言う", "からこそ", "からする", "からって", "からみる", "かりそめにも", "仮にも", "かれ", "辛うじて", "代わりに", "切っ掛け", "きっと", "気味", "嫌いがある", "きり", "切る", "極まりない", "極み", "臭い", "くせ", "げ", "結局", "決して…ない", "けど", "けれど", "現在", "越し", "事", "こと請け合いだ", "事がある", "事が出来る", "事この上ない", "如し", "事だ", "事だから", "事だし", "事だろう", "事で", "事と思う", "こととて", "事なく", "事なしに", "毎に", "事にしている", "事にする", "事になっている", "事になる", "事には", "事は…が", "事はない", "事はならない", "この度", "込む", "ご覧", "これだと", "これでは", "さあ", "際", "最中", "差し支えない", "流石", "さっぱり", "さほど", "しいしい", "然し", "然しながら", "仕方がない", "従って", "実は", "しはする", "始末だ", "じゃあ", "じゃない", "じゃないか1", "じゃないか2", "じゃないが", "じゃないだろうか", "中", "瞬間", "しょうがない", "ず", "末に", "過ぎない", "過ぎる", "直ぐ", "少なくとも", "直ぐにでも", "尽くめ", "少しも…ない", "ずじまいだ", "即ち", "ずに", "ずにいる", "ずに置く", "ずに済む", "ずにはいられない", "ずには置かない", "ずには済まない", "すら", "所為", "せいぜい", "刹那", "是非", "せられたい", "ぜんぜん…ない", "そう…ない", "そう言えば", "そうしたら", "そうして", "そうすると", "そうだ1", "そうだ2", "そこへ", "そこへいくと", "そしたら", "その…その", "その内", "そのくせ", "そばから", "そもそも", "それこそ", "それでこそ", "それにしては", "それにしても", "それはそうと", "それはそれで良い", "それはそれとして", "それ程", "それまでだ", "それ故", "それを", "大概", "大した", "大して…ない", "大体", "大抵", "大変", "たかだか", "だから", "だからこそ", "たがる", "だけ1", "だけ2", "だけ3", "だけど", "ただでさえ", "たっけ", "だったら", "だって1", "だって2", "だって3", "たて", "だと", "だと良い", "だと言って", "たとえ", "例えば", "だとすると", "だとすれば", "だなんて", "だにしない", "度に", "多分", "堪らない", "為", "試し", "たら1", "たら2", "たら良い", "たらどうか", "たり", "たりとも", "たる", "たろう", "違いない", "ちっとも…ない", "因みに", "ちゃんと", "ちょっと", "つ…つ", "遂に", "つきましては", "っきり", "っこない", "ったら", "ってば", "て…て", "てあげる", "てある", "であろうと", "て良い", "て行く", "ていけない", "て頂く", "ていはしまいか", "ている", "て置く", "てから", "て下さい", "て下さる", "て来る", "てくれ", "てくれる", "てこそ", "て差し上げる", "て仕舞う", "てしょうがない", "て堪らない", "て頂戴", "てっきり…と思う", "てでも", "でなくて何だろう", "てならない", "ての事", "では1", "では2", "ではあるが", "ではあるまいか", "てはいけない", "ては駄目だ", "てはどうか", "ではない", "ではないか1", "ではないか2", "ではないだろうか", "ではなかったか", "ではなかろうか", "ではなくて", "てはならない", "て見せる", "てみる", "でも1", "でも2", "でもあり、でもある", "ても良い", "ても構わない", "ても差し支えない", "ても仕方がない", "でもって", "でもない", "ても宜しい", "て貰う", "てやまない", "てやる", "点", "と1", "と2", "と相まって", "と良い", "といい…といい", "と言いますと", "と言う1", "と言う2", "と言う事", "と言うところだ", "と言うのも", "と言うものだ", "と言うものではない", "と言うより", "といえど", "と言えなくもない", "といけない", "と言った", "と言ったらありはしない", "と言ったらありゃしない", "と言ったらない", "と言っては", "と言っても間違いない", "と言わず…と言わず", "どうしても", "同時に", "同然", "とうてい…ない", "どうにか", "どうにも", "どうもない", "どうやら", "道理", "通し", "通して", "通す", "と思う", "通り", "とか1", "とか2", "とかく", "と考えられる", "時", "と聞く", "と来た日には", "と来たら", "と来ているから", "時として", "時に", "時には", "何処か", "何処となく", "所1", "所2", "どころ", "ところで", "ところに", "ところを", "とされている", "としたら", "として…ない", "としても", "とする1", "とする2", "とすると", "とすれば1", "とすれば2", "途端", "と違って", "途中", "とて", "とても", "とでも言う", "となく", "となったら", "となっては", "となれば", "とにかく", "とは言いながら", "とは言うものの", "とは言っても", "とは打って変わって", "とばかり", "と見えて", "ども1", "ども2", "ともあろうものが", "とも限らない", "ともかく", "ともなると", "ともなれば", "とやら", "取り分け", "とんだ", "とんでもない", "どんな", "どんなに", "ないか", "ないかしら", "ないかな", "ないことはない", "ないこともない", "ないである", "ないでいる", "ないで置く", "ないでくれ", "ないで済む", "ないではいられない", "ないでは置かない", "ないでは済まない", "ないでも良い", "ないと", "ないと良い", "ないとも限らない", "ないものか", "尚", "直す", "流す", "なきゃ", "なくしては", "なくちゃ", "なくては", "なくてはいけない", "なくても良い", "なくとも良い", "なくもない", "なけりゃ", "なければ", "なさんな", "なしでは…ない", "何故か", "何故…かと言うと", "何故かと言うと…からだ", "何故かと言えば…からだ", "何故ならば…からだ", "等", "何…ない", "何か", "何かしら", "何かと", "何が何でも", "何かにつけて", "何気ない", "何にも増して", "何も", "何やら", "何より", "なまじ", "なら1", "なら2", "なら3", "なら良い", "ならでは", "なり1", "なり2", "なり3", "なりと", "なる", "なるたけ", "なるべく", "成程", "慣れた", "何か…ものか", "何だか", "なんて1", "なんて2", "何とか言う", "何としても", "何となく", "何とはなしに", "何とも", "何にしても", "何にしろ", "何ら…ない", "に当たって", "に当たり", "にあって", "に至る", "に言わせれば", "に於いて", "に応じて", "におかれましては", "に於ける", "にかかっては", "に関わらず", "に関わる", "にかぎったことではない", "にかけたら", "にかけて", "にかこつけて", "にかまけて", "に代わり", "に関して", "に決まってる", "に比べて", "に加え", "に加えて", "に答え", "に答えて", "に際し", "に際して", "に先立ち", "に先立って", "に従い", "に従って", "にしたって", "にしたら", "にしてみれば", "にしろ", "にせよ", "に即して", "に沿って", "に対して", "に対する", "に耐えない", "に耐える", "に足りない", "に足る", "に連れて", "にて", "二度と…ない", "に留まらず", "に伴い", "に伴って", "になく", "には当たらない", "には及ばない", "に反し", "に反して", "に引き換え", "に他ならない", "に向かって", "に向けて", "に面して", "にも", "にも関わらず", "に基いて", "にもなく", "にもならない", "によって", "により", "による", "によれば", "に渡って", "に渡り", "抜き", "抜く", "ぬまでも", "ねばならぬ", "の1", "の2", "の…の", "のか", "のだった", "のだったら", "のだろう", "のであった", "のである", "のです", "のでは", "のではなかったか", "のに1", "のに2", "のは…だ", "は…で", "場合", "はい", "ば良い", "は疎か", "ばかりか", "ばかりでなく…も", "初め", "初めて", "筈", "弾み", "果たして", "放し", "早いか", "範囲で", "反対に", "控えて", "非常に", "比ではない", "一つ", "一つ間違えば", "一通り", "ひとり…だけでなく", "ひとり…のみならず", "風", "節がある", "不足はない", "ふと", "振り", "振る", "べからざる", "べからず", "べき", "べし", "下手", "別段", "別として", "別に", "ぽい", "方", "放題", "他", "欲しい", "欲しがる", "程", "程なく", "殆ど", "前", "正に", "まして", "先ず", "又", "又しても", "又は", "又もや", "全く", "まみれ", "間もなく", "まるで", "回る", "まんざら", "まんまと", "見える", "見込み", "見込んで", "見せる", "みたいだ", "みだりに", "見る", "向き", "向く", "向けで", "無闇に", "無理", "めく", "巡って", "滅多に", "もう1", "もう2", "もう直ぐ", "も構わず", "目されている", "もさる事ながら", "もし", "もしかしたら", "もしも", "勿論", "もって1", "もって2", "もっと", "もっぱら", "下", "元々", "元より", "もの", "ものがある", "ものだ", "ものだから", "ものでもない", "ものと思う", "ものとする", "最早", "や1", "や2", "やがて", "安い", "やたらに", "やなんぞ", "止む", "故", "よう1", "よう2", "要するに", "ようだ1", "ようだ2", "ような1", "ような2", "ように1", "ように2", "ように3", "漸く", "良かった", "良かろう", "良く", "よそに", "よほど", "よもや", "られる1", "られる2", "れる1", "れる2", "ろく", "ろくろく", "わ…わ", "訳がない", "訳だ", "訳ではない", "分けても", "訳にはいけない", "わざわざ", "僅か", "割", "を…とする", "を…にひかえて", "をおいて", "を限りに", "を皮切りに", "を禁じえない", "を契機として", "を込めて", "をして…させる", "を前提に", "を頼りに", "を通じて", "を除いて", "を踏まえ", "を基に", "をものともせずに", "を余儀なくさせる", "を余儀なくされる", "んじゃ", "んじゃない", "んじゃないか", "んじゃないだろうか", "んじゃなかったか", "んだ", "んだった", "んだって", "んだろう", "んで", "んです", "あいだ", "あいだに", "あいまって", "あたって", "あたらない", "あって", "あと", "あまりの～に", "いかんだ", "いかんで", "いかんでは", "いかんにかかわらず", "いかんによって", "いかんによっては", "いかんによらず", "いじょう（は）", "いただく", "いたって", "いたっては", "いたり", "いたる", "いたるまで", "いちばん", "いっぽう（で）", "いっぽうだ", "いなや", "いらい", "うえ（に）", "うえで", "うえで〈目もく的てき〉", "うえは", "うちに〈時じ間かん幅はば〉", "うちに〈事じ前ぜん〉", "えない", "える", "お～・ご～", "お～いたす", "おうじて", "おうずる", "おかげか", "お～ください", "おける", "おそれがある", "お～だ", "おり（に）", "おろか", "おわる", "が〈逆ぎゃく接せつ〉", "が〈前まえ置おき・和やわらげ〉", "がい", "かいがあって", "がいちばん", "かいもなく", "かかわらず", "かかわりなく", "かかわる", "かぎって", "かぎらず", "かぎり（は）〈条じょう件けんの範はん囲い〉", "かぎり〈限げん界かい〉", "かぎり", "かぎりだ", "かぎりでは", "かぎりに", "かぎる", "かけだ", "かけては", "がさいご", "がする", "かたくない", "が～だけに", "かたわら", "（か）とおもうと", "かとおもうほど", "（か）とおもったら", "か～ないかのうちに", "かねない", "かのようだ", "がはやいか", "がほしい", "かまわず", "から〈原げん因いん・理り由ゆう〉", "から〈原げん因いん〉", "からある", "からいうと", "からいえば", "からいって", "からいっても", "からしても", "からすると", "からすれば", "からでないと", "からといって", "から～にかけて", "からの", "かわきりに", "かわって", "かわりに〈代だい償しょう〉", "かわりに〈代だい理り〉", "かんして", "かんする", "きっかけにして", "きまっている", "ぎみ", "きりだ", "きる", "きれない", "きれる", "きわまりない", "きわまる", "きわみ", "きんじえない", "くする", "くせして", "ください", "くださいませんか", "くださる", "くなる", "くらい〈程てい度ど〉", "くらい〈軽けい視し〉", "くらいだ", "くらいなら", "ぐらいなら", "くらい～はない", "くらべて", "くれる", "くわえて", "け", "けいきにして", "けれど（も）〈逆ぎゃく接せつ〉", "けれど（も）〈前まえ置おき・和やわらげ〉", "ご～", "こしたことはない", "こたえて", "こたえる", "ことができる", "ごとき", "ごとく", "ことだ〈感かん慨がい〉", "ことだ〈助じょ言げん・忠ちゅう告こく〉", "ことだ", "ことだから", "ことだし", "ことだろう", "こととなっている", "こととなると", "ことなく", "ことなしに", "ことに（は）", "ことになっている", "ことになる〈決けっ定てい〉", "ことになる〈結けっ局きょく〉", "ことには", "ことは～が", "こない", "こめて", "さい（に）", "さいして", "さいちゅう（に）", "さいちゅうだ", "さえ～ば", "さきだつ", "さきだって", "さしあげる", "させていただけませんか", "させてください", "させてくれませんか", "させてもらえませんか", "させられる", "させる〈強きょう制せいの使し役えき〉", "させる〈誘ゆう発はつの使し役えき〉", "させる〈許きょ可か・恩おん恵けいの使し役えき〉", "させる〈責せき任にんの使し役えき〉", "させる〈他た動どう詞し化かの使し役えき〉", "さておき", "さることながら", "ざるをえない", "しかたがない", "しかない", "しだい", "しだいだ", "しだいで", "しだいでは", "したって", "したところで", "したら", "している", "しては", "しても", "しても～しても", "してる", "しまつだ", "じゃいけない", "じゃう", "じゃかなわない", "じゃないか", "しろ〈命めい令れい〉", "しろ", "しろ〈命めい令れい〉と（言いう）", "しろ～しろ", "すえ（に）", "すぎない", "すぎる", "ずくめ", "ずじまい", "ずにはおかない〈自じ発はつ的てき作さ用よう〉", "ずにはおかない〈必かならずする〉", "ずにはすまない", "すら〈強きょう調ちょう〉", "すれば", "せいか", "せいで", "せよ", "せよ～せよ", "そう", "そういない", "そうだ〈伝でん聞ぶん〉", "そうだ〈様よう子す〉", "そうだ〈直ちょく前ぜん〉", "そうだ〈予よ想そう・判はん断だん〉", "そうもない", "そくした", "そくして", "そって", "たいして", "たいする", "たいものだ〈願がん望ぼう〉", "たえない", "たえる", "たがさいご", "だけある", "だけでなく", "だけに〈ふさわしく〉", "だけに〈反はん予よ想そう〉", "だけの", "だけまし", "たことがある〈経けい験けん〉", "たことがある〈過か去この特とく別べつなこと〉", "だす", "（ただ）～だけでなく", "ただ～のみ", "ただ～のみならず", "たとえ～ても", "たところ", "たところだ", "たとたん（に）", "たなら～だろうに", "たばかりだ", "たび（に）", "たほうがいい", "ため（に）〈目もく的てき〉", "ため（に）〈恩おん恵けい〉", "ため（に）〈原げん因いん〉", "たら〈その後あとで〉", "たら〈条じょう件けん〉", "たら～（のに）", "たらいい〈勧すすめ〉", "たらいい〈希き望ぼう〉", "たらいい", "たらいいですか", "たらさいご", "たら～た", "たら～だろう（に）", "たり～たりする〈複ふく数すうの行こう為い〉", "たり～たりする〈不ふ定てい〉", "たり～たりする〈反はん復ぷく〉", "たりとも～ない", "だろう〈推すい量りょう〉", "だろう〈気き持もちの強きょう調ちょう〉", "だろうとおもう", "ちがいない", "ちゃ", "ちゃいけない", "ちゃう", "ちゃかなわない", "ちゅうしんにする", "ついて", "つうじて", "つき", "つけて", "ったらない", "つつ〈逆ぎゃく接せつ〉", "つつ〈同どう時じ進しん行こう〉", "つ～つ", "つつある", "つづける", "つつも", "って〈伝でん聞ぶん〉", "って〈主しゅ題だい〉", "って〈名な前まえ〉", "っていう", "っていうことは", "っていうのは", "っていえば", "ってことは", "つもりだ〈意い志し〉", "つもりだ〈意い図とと実じっ際さいの不ふ一いっ致ち〉", "つれて", "て〈並へい列れつ・対たい比ひ〉", "て〈順じゅん次じ・前ぜん段だん階かい〉", "て〈方ほう法ほう・状じょう態たい〉", "て〈理り由ゆう・原げん因いん〉", "て〈緩ゆるい連れん結けつ〉", "であれ～であれ", "ていく", "ていただく", "ていない", "ていらい", "ている〈進しん行こう・継けい続ぞく〉", "ている〈習しゅう慣かん・反はん復ぷく・職しょく業ぎょう・身み分ぶん〉", "ている〈変へん化かの結けっ果かの残ざん存そん〉", "ている〈初はじめからの外がい見けん、状じょう態たい〉", "ている〈経けい歴れき・経けい験けん〉", "ているところだ", "ておく", "てから〈動どう作さの順じゅん序じょ〉", "てから〈起き点てん〉", "てからでないと", "てからでなければ", "てからというもの（は）", "てからは", "できる", "てください", "てくださいませんか", "てくださる", "てくる〈行いって戻もどる〉", "てくる〈順じゅん次じ〉", "てくる〈変へん化か〉", "てくる〈継けい続ぞく〉", "てくる〈移い動どうの状じょう態たい〉", "てくる〈方ほう向こう性せい〉", "てくる〈話わ者しゃへの接せっ近きん・離り反はん〉", "てくる〈話わ者しゃへの接せっ近きん〉", "てくる〈変へん化かの出しゅつ現げん〉", "でさえ", "てさしあげる", "てしかたがない", "でしかたがない", "てしまう〈完かん了りょう〉", "てしまう〈残ざん念ねん〉", "でしょう〈同どう意い求もとめ　確かく認にん〉", "でしょう", "ですら", "てたまらない", "てない", "でなくてなんだろう", "ではありません", "ではあるまいし", "ではいられない", "てはかなわない", "ではかなわない", "てはじめて", "ではないか〈感かん動どう〉", "ではないか〈判はん断だん〉", "てほしい", "てほしいものだ", "てほしいもんだ", "てまえ", "てまで", "てみせる", "てもいい〈許きょ可か〉", "てもいい〈譲じょう歩ほ〉", "でもいい", "てもかまわない〈許きょ可か〉", "てもかまわない〈譲じょう歩ほ〉", "でもかまわない", "てもさしつかえない", "でもさしつかえない", "てもらう", "てる", "てるところ", "と〈条じょう件けん〉", "と〈継けい起き〉", "と〈直ちょく接せつ話わ法ほう〉", "と〈間かん接せつ話わ法ほう〉", "と～（のに）〈反はん実じつ仮か想そう〉", "とあいまって", "とあれば", "といい〈希き望ぼう〉", "といい〈勧すすめ〉", "といい～といい", "という〈名な前まえの紹しょう介かい〉", "という〈名な前まえ〉", "という〈内ない容よう説せつ明めい〉", "というか～というか", "ということだ〈伝でん聞ぶん〉", "ということだ〈結けつ論ろん〉", "というと〈連れん想そう〉", "というと〈確かく認にん〉", "というと", "というところだ", "というのは", "というもの", "というものだ", "というものではない", "というものでもない", "というものは", "というより", "といえども～ない", "といえば", "といったら", "といったらありはしない", "といったらありゃしない", "といったらない", "といっても", "といわず～といわず", "とおして", "とおもいきや", "とおもうと", "とおり（に）", "どおり（に）", "とおりだ", "とか～とか", "とき", "ときたら", "とく", "ところ ＋ 助じょ詞し（で・に・へ・を）", "どころか〈正せい反はん対たい〉", "どころか〈程てい度どの対たい比ひ〉", "ところだった", "どころではなく", "ところをみると", "としたって", "としたところで", "として～ない", "としない", "とすれば", "と～た〈きっかけ〉", "と～た〈発はっ見けん〉", "と～た〈偶ぐう然ぜん〉", "とたん（に）", "どちら", "どっち", "とって", "と～とどちら", "とどまらず", "とともに〈いっしょに〉", "とともに〈相そう関かん関かん係けい〉", "とともに〈同どう時じ〉", "とともに〈付ふ加か〉", "となると〈新しん事じ態たいの仮か定てい・確かく定てい〉", "となると〈話わ題だい〉", "とのことだ", "とは〈定てい義ぎ〉", "とは〈驚おどろき〉", "とはいうものの", "とはいえ", "とはかぎらない", "とばかり（に）", "とみえて", "とみえる", "ともあろう", "ともかく（として）", "ともなしに", "ともなって", "とわず", "な〈禁きん止し〉", "な〈禁きん止し〉と（言いう）", "ないうちに", "ないかぎり", "ないかのうちに", "ないことがある", "ないことにする", "ないことになる", "ないつもりだ", "ないでおく", "ないでください", "ないではおかない", "ないではすまない", "ないどく", "ないほうがいい", "ないものでもない", "ないもんでもない", "ないように", "ないようにする", "ないわけにはいかない", "ながら〈同どう時じ進しん行こう〉", "ながら〈逆ぎゃく接せつ〉", "ながら〈そのまま〉", "ながらに", "ながらにして", "ながらの", "ながらも", "なきゃいけない", "なきゃならない", "なくして（は）", "なくたっていい", "なくたってかまわない", "なくちゃならない", "なくっていい", "なくて〈並へい列れつ・理り由ゆう〉", "なくて〈理り由ゆう〉", "なくてはならない", "なくてもいい〈不ふ必ひつ要よう〉", "なくてもいい〈譲じょう歩ほ〉", "なくてもかまわない", "なければいけない", "なら（ば）", "なら～ほど", "ならいい", "ならいざしらず", "なり～なり", "なんか", "にあたって", "にあたらない", "にいたって", "にいたる", "にいたるまで", "において", "におうじた", "におうじて", "における", "にかかわらず", "にかかわりなく", "にかかわる", "にかぎって", "にかぎらず", "にかぎり", "にかぎる", "にかたくない", "にかわって", "にかんして", "にかんする", "にきまっている", "にくい", "にくらべて", "にくわえて", "にこしたことはない", "にこたえて", "にこたえる", "にさいして", "にさきだつ", "にさきだって", "にしたがって", "にして〈程てい度ど強きょう調ちょう〉", "にしても〈逆ぎゃく接せつ仮か定てい〉", "にしても〈譲じょう歩ほ〉", "にしても～にしても", "にしろ～にしろ", "にすぎない", "にすれば", "にせよ～にせよ", "にそう", "にそういない", "にそくした", "にそくして", "にそった", "にそって", "にたいして〈対たい象しょう〉", "にたいして〈対たい比ひ〉", "にたいする", "にたえない", "にたえる", "にたる", "にちがいない", "につけて", "につれて", "にともなって", "になる", "に（は）あたらない", "にはかかわりなく", "にはんして", "にはんする", "にもとづいた", "にもとづいて", "にもとづく", "にもまして", "によって〈原げん因いん・理り由ゆう〉", "によって〈手しゅ段だん・方ほう法ほう〉", "によって〈受うけ身みの動どう作さ主しゅ〉", "によって〈対たい応おう〉", "によっては", "にわたった", "にわたって", "にわたり", "にわたる", "ぬきで", "ぬきに", "ぬきにしては", "ぬきの", "ぬく", "のいたり", "のうえで", "のきわみ", "のことだ", "のだ〈説せつ明めい〉", "のだ〈言いい換かえ〉", "のだ〈主しゅ張ちょう〉", "のだ〈納なっ得とく〉", "のだから", "のだった〈感かん慨がい〉", "のだった〈後こう悔かい〉", "のですか", "のですが", "のではありません", "のに〈逆ぎゃく接せつ　不ふ満まん・予よ想そう外がい〉", "のに〈対たい比ひ〉", "のに〈用よう途と〉", "のほう", "のもとで", "のもとに", "ば〈条じょう件けん〉", "ば～（のに）〈反はん実じつ仮か想そう〉", "ばいい〈勧すすめ〉", "ばいい〈希き望ぼう〉", "ばいいですか", "はいざしらず", "は～が～", "は～が、～は", "ばかりだ", "ばかりでなく", "はさておき", "はじめ", "はじめとして", "はじめとする", "はじめる", "はずがない", "はずだ〈必ひつ然ぜん的てき帰き結けつ〉", "はずだ〈当とう然ぜん〉", "はずはない", "ばそれまでだ", "ば～だろうに", "はというと", "はともかく（として）", "はとわず", "はべつとして", "ば～ほど", "はもちろん", "はもとより", "は～より", "はんした", "はんして", "はんする", "はんめん", "ひきかえ", "ひとり～のみならず", "ふまえて", "べきではない", "べつとして", "ほう", "ほかしかたがない", "ほかない", "ほかならない", "ほど〈程てい度ど〉", "ほど〈相そう関かん関かん係けい〉", "ほどだ", "ほど～ない", "ほど～はない", "はやいか", "まい〈否ひ定ていの意い志し〉", "まい〈否ひ定ていの推すい量りょう〉", "まいか", "まいが", "まいと", "まえに", "まし", "まじき", "ましょうか〈申もうし出で〉", "ましょうか〈誘さそい〉", "ませんか〈勧すすめ〉", "ませんか〈誘さそい〉", "までして", "までだ〈軽かるい気き持もち〉", "までだ〈覚かく悟ご〉", "までのことだ", "までのこともない", "までも", "みえて", "みたいだ〈推すい量りょう〉", "みたいだ〈比ひ況きょう〉", "むきだ", "むきに", "むけだ", "むけに", "めいた", "めぐって", "めぐる", "もかまわず", "もしない", "も～し、～も", "もちろん", "もって", "もとづいた", "もとづいて", "もとづく", "もとで", "もとに", "もとにした", "もとにして", "もとより", "も～なら、～も", "ものだ〈回かい想そう〉", "ものだ〈感かん慨がい〉", "ものだ〈忠ちゅう告こく〉", "もので", "ものともせず（に）", "も～ば、～も", "もん", "もんか", "もんじゃない", "もんだ", "もんだから", "もんで", "もんでもない", "やいなや", "やすい", "やら～やら", "ゆえ（に）", "よう〈意い志し〉", "ようか", "ようが", "ようがない", "ようか～まいか", "ようが～まいが", "ようだ〈比ひ況きょう〉", "ようだ〈推すい量りょう〉", "ようだ〈婉えん曲きょく〉", "ようではないか", "ようと（も）", "ようとおもう", "ようとしている", "ようとしない", "ようとする", "ようと～まいと", "ような", "ように〈期き待たい〉", "ように〈同どう様よう〉", "ように（と言いう）〈間かん接せつ話わ法ほう〉", "ようにして", "ようにも～ない", "ようもない", "よぎなくさせる", "よぎなくされる", "よし", "よって", "より～のほう", "よりほかしかたがない", "よりほかない", "よる", "よると", "よれば", "らしい〈推すい量りょう〉", "らしい〈典てん型けい〉", "られる〈可か能のう〉", "られる〈性せい能のう評ひょう価か〉", "られる〈受うけ身み〉", "られる〈非ひ情じょうの受うけ身み〉", "られる〈持もち主ぬしの受うけ身み〉", "られる〈被ひ害がいの受うけ身み〉", "られる〈尊そん敬けい〉", "られる〈自じ発はつ〉", "わけはない", "わたった", "わたって", "わたり", "わたる", "わりに（は）", "をかぎりに", "をかわきりに（して）", "をきっかけに（して）", "をきんじえない", "をください", "をくださいませんか", "をけいきに（して）", "をこめて", "をしている", "をちゅうしんとして", "をちゅうしんとする", "をちゅうしんに", "をちゅうしんにする", "をつうじて〈継けい続ぞく期き間かん〉", "をつうじて〈手しゅ段だん・媒ばい介かい〉", "をとおして〈継けい続ぞく期き間かん〉", "をとおして〈手しゅ段だん･媒ばい介かい〉", "を～として", "を～とする", "をとわず", "を～にして", "をぬきにして", "をぬきにしては", "をはじめ", "をはじめとして", "をはじめとする", "をふまえて", "をめぐって", "をめぐる", "をもって〈手しゅ段だん〉", "をもって〈期き限げん〉", "をもとに（して）", "をもとにした", "をものともせず（に）", "をよぎなくさせる", "をよぎなくされる", "んがため（に）", "んだった〈後こう悔かい〉", "んですか", "んですが", "んばかりだ", "んばかりに"];

    let vocab = document.querySelector('.plain').cloneNode(true)
    let rts = vocab.querySelectorAll('rt')
    rts.forEach(function (rt) { rt.remove() })

    grammarPoints.every(point => {
        if (point.includes(vocab.innerText)) {
            let grammarBadge = document.createElement('span');
            grammarBadge.innerText = 'grammar';
            grammarBadge.classList.add('grammar-badge');
            grammarBadge.classList.add("badge")

            waitForElm('.badges').then((elm) => {
                elm.insertAdjacentElement('beforeend', grammarBadge)
            });

            return false;
        }

        return true;
    });
}

function waitForElm(selector) {
    return new Promise(resolve => {
        if (document.querySelector(selector)) {
            return resolve(document.querySelector(selector));
        }

        const observer = new MutationObserver(mutations => {
            if (document.querySelector(selector)) {
                resolve(document.querySelector(selector))
                observer.disconnect()
            }
        });

        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    });
}